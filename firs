CREATE OR REPLACE FUNCTION api.get_coastline_shapes() RETURNS TABLE (coastline_shape INTEGER, point_count INTEGER) AS $$
BEGIN
    RETURN QUERY
    SELECT shape AS coastline_shape, COUNT(*)::integer AS point_count
    FROM data.coastline
    GROUP BY shape
    HAVING COUNT(*) > 1;
END;
$$ LANGUAGE plpgsql;

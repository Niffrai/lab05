CREATE OR REPLACE FUNCTION api.get_country_cities_count()
RETURNS TABLE (country_id INTEGER, city_count INTEGER) AS $$
BEGIN
    RETURN QUERY
    SELECT CAST(country AS INTEGER) AS country_id, COUNT(*) AS city_count
    FROM data.city
    GROUP BY country_id;
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION data.create_partition(y1 INT, y2 INT)
RETURNS VOID AS $$
DECLARE
    start_date DATE;
    end_date DATE;
    curr_date DATE;
    partition_name TEXT;
BEGIN
    FOR year IN y1..y2 LOOP
        FOR month IN 1..12 LOOP
            start_date := DATE(year, month, 1);
            end_date := start_date + INTERVAL '1 month' - INTERVAL '1 day';
            partition_name := 'part_y' || year || 'm' || LPAD(month::TEXT, 2, '0');
            
            EXECUTE 'CREATE TABLE IF NOT EXISTS data.measurement_' || partition_name || ' PARTITION OF data.measurement '
                'FOR VALUES FROM (''' || start_date || ''') TO (''' || end_date || ''')';
        END LOOP;
    END LOOP;
END;
$$ LANGUAGE plpgsql;

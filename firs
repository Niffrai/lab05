ERROR:  syntax error at or near "TO_CHAR"
LINE 12:             d0 := DATE_TRUNC('MONTH', TIMESTAMP (TO_CHAR(y, ...
                                                          ^ 

SQL state: 42601
Character: 304

CREATE OR REPLACE FUNCTION api.get_coastline_shapes()
  RETURNS TABLE (shape_id INTEGER, point_count INTEGER)
AS $$
BEGIN
  RETURN QUERY
  SELECT shape, COUNT(*) AS point_count
  FROM data.coastline
  GROUP BY shape
  HAVING COUNT(*) > 1;
END;
$$ LANGUAGE plpgsql;

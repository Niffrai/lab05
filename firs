CREATE OR REPLACE FUNCTION api.get_countries_by_region(region_id INTEGER) RETURNS TABLE (country_id INTEGER, country_name TEXT) AS $$
BEGIN
    RETURN QUERY
    SELECT c.country_id, c.country_name
    FROM data.country c
    INNER JOIN data.region r ON c.region_id = r.region_id
    WHERE r.region_id = region_id;
END;
$$ LANGUAGE plpgsql;

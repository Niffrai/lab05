CREATE OR REPLACE FUNCTION api.get_city_count_by_country() RETURNS TABLE (country_id INTEGER, city_count INTEGER) AS $$
BEGIN
    RETURN QUERY
    SELECT c.country_id, COUNT(*) AS city_count
    FROM data.city c
    GROUP BY c.country_id;
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE VIEW data.partition_stats AS
SELECT
    tableoid::regclass AS partition_name,
    pg_total_relation_size(tableoid) AS total_size,
    pg_indexes_size(tableoid) AS index_size,
    reltuples AS row_count
FROM
    pg_class
WHERE
    relname LIKE 'measurement_part_y%'
    AND reltuples > 0
ORDER BY
    reltuples ASC;

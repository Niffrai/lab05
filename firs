CREATE OR REPLACE VIEW data.partition_stats AS
SELECT
    pg_partition_tree.partrelid::regclass AS partition_name,
    pg_partition_tree.n_live_tup AS row_count
FROM
    pg_partition_tree('measurement'::regclass) AS pg_partition_tree
WHERE
    pg_partition_tree.n_live_tup > 0
ORDER BY
    pg_partition_tree.n_live_tup ASC;

CREATE OR REPLACE FUNCTION api.count_countries_per_region()
  RETURNS TABLE (region_id INTEGER, country_count INTEGER)
AS $$
BEGIN
  RETURN QUERY
  SELECT region.region_id, COUNT(country.country_id) AS country_count
  FROM data.region AS region
  LEFT JOIN data.country AS country ON region.region_id = country.region_id
  GROUP BY region.region_id;
END;
$$ LANGUAGE plpgsql;
